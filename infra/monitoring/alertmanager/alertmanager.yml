global:
  resolve_timeout: 5m
  slack_api_url: $SLACK_WEBHOOK_URL

route:
  group_by: [alertname, cluster]
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 4h
  receiver: slack-alerts
  routes:
    - match: { severity: critical }
      receiver: pagerduty-critical
    - match: { severity: warning }
      receiver: slack-alerts

receivers:
  - name: slack-alerts
    slack_configs:
      - channel: "#alerts"
        title: "{{ .GroupLabels.alertname }}"
        text: "{{ range .Alerts }}{{ .Annotations.summary }}\n{{ end }}"

  - name: pagerduty-critical
    pagerduty_configs:
      - service_key: $PAGERDUTY_KEY
        description: "{{ .GroupLabels.alertname }}"
